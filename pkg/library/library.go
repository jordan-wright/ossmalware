package library

import "fmt"

type Package struct {
	Name    string `json:"name,omitempty"`
	Version string `json:"version,omitempty"`
	Type    string `json:"type,omitempty"`
}

func (p Package) ID() string {
	return fmt.Sprintf("%s-%s-%s", p.Type, p.Name, p.Version)
}

type Output struct {
	Files    []string  `json:"files"`
	Package  Package   `json:"package"`
	Behavior *Behavior `json:"results"`
}

type Behavior struct {
	OutboundConnections []Connection    `json:"connections"`
	DNSLookups          []DNSLookup     `json:"dns"`
	FileOperations      []FileOperation `json:"files"`
	Commands            []string        `json:"commands"`
}

type DNSLookup struct {
	Name        string   `json:"name"`
	IPAddresses []string `json:"addresses"`
}

type Connection struct {
	Protocol  string `json:"protocol"`
	IPAddress string `json:"address"`
	Port      string `json:"port"`
}

type FileOperation struct {
	Operation string `json:"mode"`
	Filename  string `json:"filename"`
	Flag      string `json:"flag"`
}
